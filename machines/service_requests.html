<div class="card p-3">
  <div class="d-flex justify-content-between mb-3 align-items-center">
    <h4 class="mb-0">Solicitudes de Servicio</h4>
    <div>
      <button class="btn btn-success btn-sm" onclick="appLoad('machines/create_request.html')">Crear Solicitud</button>
      <button class="btn btn-outline-secondary btn-sm" id="btn-refresh-req">Actualizar</button>
    </div>
  </div>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead class="table-light"><tr><th>ID</th><th>Número</th><th>Máquina</th><th>Cliente</th><th>Tipo</th><th>Estado</th><th>Acciones</th></tr></thead>
      <tbody id="requests-tbody"></tbody>
    </table>
  </div>
</div>

<script src="../assets/js/serviceRequestService.js"></script>
<script>
async function renderRequests(){
  const list = await serviceRequestService.list().then(r=>r.data||r).catch(()=>[]);
  const tbody = document.getElementById("requests-tbody");
  tbody.innerHTML='';
  (list||[]).forEach(r=>{
    tbody.insertAdjacentHTML('beforeend', `<tr>
      <td>${r.id}</td>
      <td>${r.requestNumber||''}</td>
      <td>${r.companySerial||''}</td>
      <td>${r.customerId||''}</td>
      <td>${r.serviceType||''}</td>
      <td>${r.status||''}</td>
      <td><button class="btn btn-sm btn-primary" onclick="appLoad('machines/detail.html?id='+r.machineId)">Ver</button></td>
    </tr>`);
  });
}
document.addEventListener("DOMContentLoaded", ()=>{ renderRequests(); document.getElementById('btn-refresh-req').addEventListener('click', renderRequests); });
</script>