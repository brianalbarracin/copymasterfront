<div class="card p-3">
  <h4>Crear Solicitud</h4>
  <form id="form-create-request" class="row g-3">
    <div class="col-md-6"><label class="form-label">Machine ID *</label><input class="form-control" name="machineId" required></div>
    <div class="col-md-6"><label class="form-label">Cliente (customerId)</label><input class="form-control" name="customerId"></div>
    <div class="col-md-6"><label class="form-label">Canal</label>
      <select name="reportedChannel" class="form-select">
        <option value="telefono">Teléfono</option><option value="whatsapp">WhatsApp</option><option value="email">Email</option><option value="portal">Portal</option>
      </select>
    </div>
    <div class="col-md-6"><label class="form-label">Tipo de servicio</label>
      <select name="serviceType" class="form-select">
        <option value="correctivo">Correctivo</option><option value="preventivo">Preventivo</option><option value="diagnostico">Diagnóstico</option><option value="toner">Toner</option><option value="toma_contador">Toma contador</option><option value="otro">Otro</option>
      </select>
    </div>
    <div class="col-12"><label class="form-label">Root cause</label><input class="form-control" name="rootCause"></div>
    <div class="col-12"><label class="form-label">Descripción</label><textarea class="form-control" name="description" rows="4"></textarea></div>
    <div class="col-12"><button class="btn btn-success" type="submit">Crear</button></div>
  </form>
</div>

<script src="../assets/js/serviceRequestService.js"></script>
<script>
document.getElementById("form-create-request").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  try{ await serviceRequestService.create(data); alert("Solicitud creada"); appLoad('machines/service_requests.html'); }
  catch(err){ alert("Error: "+err.message); }
});
</script>